<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Struct optimal_learning::LogMarginalLikelihoodState
 | qiotoolkit </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Struct optimal_learning::LogMarginalLikelihoodState
 | qiotoolkit ">
    
      <link rel="shortcut icon" href="../../../favicon.ico">
      <link rel="stylesheet" href="../../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../../styles/docfx.css">
      <link rel="stylesheet" href="../../../styles/main.css">
      <meta property="docfx:navrel" content="../../../toc.html">
      <meta property="docfx:tocrel" content="../../toc.html">
    
    <meta property="docfx:rel" content="../../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="structoptimal__learning_1_1LogMarginalLikelihoodState">



  <h1 id="structoptimal__learning_1_1LogMarginalLikelihoodState" data-uid="structoptimal__learning_1_1LogMarginalLikelihoodState" class="text-break">Struct optimal_learning::LogMarginalLikelihoodState
</h1>
  <div class="markdown level0 summary"><p>\rst State object for <a class="xref" href="log-marginal-likelihood-evaluator.html">LogMarginalLikelihoodEvaluator</a>. This object tracks the covariance object as well as derived quantities that (along with the training points/values in the Evaluator class) fully specify the log marginal likelihood. Since this is used to optimize the log marginal likelihood, the covariance's hyperparameters are variable.
See general comments on State structs in <a href="xref:gpp__common_8hpp">gpp_common.hpp</a>'s header docs. \endrst</p>
</div>
  <div class="markdown level0 conceptual"></div>
  <!--<h6><strong>Namespace</strong>: </h6>-->
  <!--<h5 id="structoptimal__learning_1_1LogMarginalLikelihoodState_syntax">Syntax</h5>
  <div class="codewrapper">
    <pre><code class="lang- hljs"></code></pre>
  </div>
  -->
  <h3 id="constructors">Constructors
</h3>


  <h4 id="structoptimal__learning_1_1LogMarginalLikelihoodState_1a9a76efe139d738ba007d68fa04158cd7" data-uid="structoptimal__learning_1_1LogMarginalLikelihoodState_1a9a76efe139d738ba007d68fa04158cd7">LogMarginalLikelihoodState()</h4>
  <div class="markdown level1 summary"><p>\rst Constructs a <a class="xref" href="log-marginal-likelihood-state.html">LogMarginalLikelihoodState</a> object with a specified covariance object (in particular, new hyperparameters). Ensures all state variables &amp; temporaries are properly sized. Properly sets all state variables so that the Evaluator can be used to compute log marginal likelihood, gradients, etc.
.. WARNING:: This object's state is INVALIDATED if the log_likelihood_eval used in construction is mutated! <a class="xref" href="log-marginal-likelihood-state.html#structoptimal__learning_1_1LogMarginalLikelihoodState_1a8fa6f8efc98620e9e1794f361f01c510">SetupState()</a> should be called again in such a situation.</p>
<p>:log_likelihood_eval</p>
<p><a class="xref" href="log-marginal-likelihood-evaluator.html">LogMarginalLikelihoodEvaluator</a> object that this state is being used with :covariance_in: the CovarianceFunction object encoding assumptions about the GP's behavior on our data \endrst</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang- hljs">optimal_learning::LogMarginalLikelihoodState::LogMarginalLikelihoodState(const EvaluatorType&amp;log_likelihood_eval, const CovarianceInterface&amp;covariance_in, const std::vector&lt;double&gt;noise_variance_in)</code></pre>
  </div>


  <h4 id="structoptimal__learning_1_1LogMarginalLikelihoodState_1a03369c673d6fa04be877a127bd13be9e" data-uid="structoptimal__learning_1_1LogMarginalLikelihoodState_1a03369c673d6fa04be877a127bd13be9e">LogMarginalLikelihoodState()</h4>
  <div class="markdown level1 summary"></div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang- hljs">optimal_learning::LogMarginalLikelihoodState::LogMarginalLikelihoodState(LogMarginalLikelihoodState&amp;&amp;other)</code></pre>
  </div>
  <h3 id="methods">Methods
</h3>


  <h4 id="structoptimal__learning_1_1LogMarginalLikelihoodState_1ac51d42354e624bac628ccf4abeb1f3d9" data-uid="structoptimal__learning_1_1LogMarginalLikelihoodState_1ac51d42354e624bac628ccf4abeb1f3d9">GetProblemSize()</h4>
  <div class="markdown level1 summary"></div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang- hljs">int optimal_learning::LogMarginalLikelihoodState::GetProblemSize() const noexcept OL_PURE_FUNCTION OL_WARN_UNUSED_RESULT</code></pre>
  </div>


  <h4 id="structoptimal__learning_1_1LogMarginalLikelihoodState_1a4eab52995c995819d7c7235c583cfe07" data-uid="structoptimal__learning_1_1LogMarginalLikelihoodState_1a4eab52995c995819d7c7235c583cfe07">SetCurrentPoint()</h4>
  <div class="markdown level1 summary"></div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang- hljs">void optimal_learning::LogMarginalLikelihoodState::SetCurrentPoint(const EvaluatorType&amp;log_likelihood_eval, double const *restrict hyperparameters) OL_NONNULL_POINTERS</code></pre>
  </div>


  <h4 id="structoptimal__learning_1_1LogMarginalLikelihoodState_1af22cd493c1e5bd5f24304253d6651458" data-uid="structoptimal__learning_1_1LogMarginalLikelihoodState_1af22cd493c1e5bd5f24304253d6651458">GetCurrentPoint()</h4>
  <div class="markdown level1 summary"></div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang- hljs">void optimal_learning::LogMarginalLikelihoodState::GetCurrentPoint(double *restrict hyperparameters) OL_NONNULL_POINTERS</code></pre>
  </div>


  <h4 id="structoptimal__learning_1_1LogMarginalLikelihoodState_1a4e593f32ca5ba8f5a0665b13806bef33" data-uid="structoptimal__learning_1_1LogMarginalLikelihoodState_1a4e593f32ca5ba8f5a0665b13806bef33">GetHyperparameters()</h4>
  <div class="markdown level1 summary"><p>\rst Get hyperparameters of underlying covariance function.
\output :hyperparameters[num_hyperparameters]: covariance's hyperparameters \endrst</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang- hljs">void optimal_learning::LogMarginalLikelihoodState::GetHyperparameters(double *restrict hyperparameters) const noexcept OL_NONNULL_POINTERS</code></pre>
  </div>


  <h4 id="structoptimal__learning_1_1LogMarginalLikelihoodState_1a6de9aa192fa17bc2546526a06fc0df06" data-uid="structoptimal__learning_1_1LogMarginalLikelihoodState_1a6de9aa192fa17bc2546526a06fc0df06">SetHyperparameters()</h4>
  <div class="markdown level1 summary"><p>\rst Change the hyperparameters of the underlying covariance function. Update the state's derived quantities to be consistent with the new hyperparameters.</p>
<p>:log_likelihood_eval</p>
<p><a class="xref" href="log-marginal-likelihood-evaluator.html">LogMarginalLikelihoodEvaluator</a> object that this state is being used with :hyperparameters[num_hyperparameters]: hyperparameters to change to \endrst</p>
<p>\rst Computes the Hessian matrix of the log (marginal) likelihood wrt the hyperparameters::
\mixpderiv{log(p(y | X, \theta_k))}{\theta_i}{\theta_j} = (-\alpha * \pderiv{K}{\theta_i} * K^-1 * \pderiv{K}{\theta_j} * \alpha)</p>
<ul>
<li>(\alpha * \mixpderiv{K}{\theta_i}{\theta_j} * \alpha)</li>
<li>0.5 * tr(-K^-1 * \pderiv{K}{\theta_i} * K^-1 * \pderiv{K}{\theta_j} + K^-1 * \mixpderiv{K}{\theta_i}{\theta_j})</li>
</ul>
<p>Note that as usual, <code>K</code> is the covariance matrix (bearing its own two indices, say <code>K_{k,l}</code>) which are omitted here.
This expression arises from differentating each entry of the gradient (see function comments for <a class="xref" href="log-marginal-likelihood-evaluator.html#classoptimal__learning_1_1LogMarginalLikelihoodEvaluator_1a832d7ce6999d7e8104e3eafb50a6a2a3">LogMarginalLikelihoodEvaluator::ComputeGradLogLikelihood</a> for expression) of the log marginal wrt each hyperparameter.
We use the identity: <code>\pderiv{K^-1}{X} = -K^-1 * \pderiv{K}{X} * K^-1</code>; as well as the fact that <code>\partial tr(A) = tr(\partial A)</code>. That is, since trace is linear, the order can be interchanged with the differential operator; and the various symmetries of the gradient/hessians of K (see function declaration comments for details on symmetry). \endrst</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang- hljs">void optimal_learning::LogMarginalLikelihoodState::SetHyperparameters(const EvaluatorType&amp;log_likelihood_eval, double const *restrict hyperparameters) OL_NONNULL_POINTERS</code></pre>
  </div>


  <h4 id="structoptimal__learning_1_1LogMarginalLikelihoodState_1a8fa6f8efc98620e9e1794f361f01c510" data-uid="structoptimal__learning_1_1LogMarginalLikelihoodState_1a8fa6f8efc98620e9e1794f361f01c510">SetupState()</h4>
  <div class="markdown level1 summary"><p>\rst Configures this state object with new hyperparameters. Ensures all state variables &amp; temporaries are properly sized. Properly sets all state variables for log likelihood (+ gradient) evaluation.
.. WARNING:: This object's state is INVALIDATED if the log_likelihood used in SetupState is mutated! <a class="xref" href="log-marginal-likelihood-state.html#structoptimal__learning_1_1LogMarginalLikelihoodState_1a8fa6f8efc98620e9e1794f361f01c510">SetupState()</a> should be called again in such a situation.</p>
<p>:log_likelihood_eval</p>
<p>log likelihood evaluator object that describes the training/already-measured data :hyperparameters[num_hyperparameters]: hyperparameters to change to \endrst</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang- hljs">void optimal_learning::LogMarginalLikelihoodState::SetupState(const EvaluatorType&amp;log_likelihood_eval, double const *restrict hyperparameters) OL_NONNULL_POINTERS</code></pre>
  </div>


  <h4 id="structoptimal__learning_1_1LogMarginalLikelihoodState_1a8bea989e7253e804cd581ca693c3ea21" data-uid="structoptimal__learning_1_1LogMarginalLikelihoodState_1a8bea989e7253e804cd581ca693c3ea21">OL_DISALLOW_DEFAULT_AND_COPY_AND_ASSIGN()</h4>
  <div class="markdown level1 summary"></div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="decalaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang- hljs">optimal_learning::LogMarginalLikelihoodState::OL_DISALLOW_DEFAULT_AND_COPY_AND_ASSIGN(LogMarginalLikelihoodState)</code></pre>
  </div>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>
              Generated with <strong>Doxygen</strong>
              and <strong>DocFX</strong></span>
              | <a href="[site-url]?version=GB"></a> (<a href="[site-url]/"></a>)
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>

    <!--
    <link rel="stylesheet" type="text/css" href="http://tikzjax.com/v1/fonts.css">
    <script src="http://tikzjax.com/v1/tikzjax.js"></script>
    -->

    <script type="text/javascript">
      document.addEventListener("DOMContentLoaded", function(event) { 
        var codes = document.getElementsByTagName("code");
        [].slice.call(codes).forEach(function(code){
          var pre = code.parentNode;
          if (pre.tagName == "PRE" && code.classList.contains('lang-math')) {
            math_div = document.createElement('div');
            math_div.innerHTML = katex.renderToString(code.textContent, { displayMode: true });
            pre.parentNode.replaceChild(math_div, pre);
          } else {
            var before = code.previousSibling;
            var after = code.nextSibling;
            if (before && before.textContent !== undefined && before.textContent.endsWith('$')
                && after && after.textContent !== undefined && after.textContent.startsWith('$'))
            {
              math_span = document.createElement('span');
              math_span.innerHTML = katex.renderToString(code.innerHTML, { displayMode: false });
              code.parentNode.replaceChild(math_span, code);
              before.textContent = before.textContent.replace(/\$$/, '');
              after.textContent = after.textContent.replace(/^\$/, '');
            }
          }
        });
      });
    </script>

  </body>
</html>
